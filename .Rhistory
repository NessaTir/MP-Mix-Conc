spec_labs <- c("P. verrucosa", "S. pistillata")
names(spec_labs) <- c("Pve", "Spi")
# Create labels for treatments
treat_labs <-  c("0", "0.1", "1", "10", "100")
names(treat_labs) <- c("control", "0.1", "1", "10", "100")
# Create a color scheme
color_scheme <- c("#4A8696", "#FFED85", "#E09F3E", "#9E2A2B", "#540B0E")
alphavalues <- c(0.005, 0.3, 0.6, 1)
surface_s <- surface_all %>%
mutate(x_axis = case_when(conc == "0" ~ "1",
conc == "0.1" ~ "2",
conc == "1" ~ "3",
conc == "10" ~ "4",
conc == "100" ~ "5"),
x_axis = as.numeric(x_axis),
Color = case_when(conc == "0" ~  "#4A8696",
conc == "0.1" ~ "#FFED85",
conc == "1" ~ "#E09F3E",
conc == "10" ~ "#9E2A2B",
conc == "100" ~ "#540B0E"))
mod_gam1 = gam(value ~ s(conc, bs = "cr", k = 5), data = surface_s)
summary(mod_gam1)
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = log(value))) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point(aes(color = Color)) +
#geom_boxplot(aes(color = Color)) +
geom_smooth(aes(x = x_axis, y = log(value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(aes(color = Color)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color, alpha=0.5)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec, alpha=0.8), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec, alpha=0.2), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black", alpha=0.2) +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black", alpha=0.8) +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black", alpha=0.8) +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
#scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_point(pch = 21, position = position_jitterdodge(), aes(fill = CreviceDepth))+
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black", alpha=0.8) +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
#scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = (value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
#geom_point(aes(color = Color)) +
geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
geom_point(pch = 21, position = position_jitterdodge(), aes(fill = Color))+
geom_smooth(aes(x = x_axis, y = (value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black", alpha=0.8) +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
#scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
# ----- 4. GAM: Relationships -------------------------------------------
## ---- 4.01. Surface ----------------------------------------------------------
### --- 4.01.1. Pve ------------------------------------------------------------
# Surface Pve
surface_Pve <- subset(surface, spec == "Pve") %>%
mutate(conc_log = log(conc+1),
value_log = log(value+100))
# fit GAM
# function s within the formula to denote the smooth terms
# bs = cr -> cubic regression splines
mod_gam1 = gam(value_log~ s(conc_log, bs = "cr", k=5), data = surface_Pve)
summary(mod_gam1)
plot(mod_gam1)
plot(mod_gam1)
summary(mod_gam1)
plot(mod_gam1)
?gam
summary(mod_gam1)
fixef(mod)
fixef(mod_gam1)
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = log(value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point(aes(color = Color)) +
#geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
#geom_point(pch = 21, position = position_jitterdodge(), aes(fill = Color))+
geom_smooth(aes(x = x_axis, y = log(value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black", alpha=0.8) +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
#scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = log(value))) +
scale_fill_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point(aes(color = Color)) +
#geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
#geom_point(pch = 21, position = position_jitterdodge(), aes(fill = Color))+
geom_smooth(aes(x = x_axis, y = log(value), lty = spec), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
#scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
# create the base graph
vol_smooth <- ggplot(volume_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Volume growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
# create table with statistical results
annotation_vol <- data.frame(
parameter = factor(x = c("volume"),
levels = c("volume")),
value = c(-1.8),
conc = c(2.5),
hjustvar = 0,
vjustvar = 1,
spec = c("Pve", "Spi"),
label = c("p = 0.0034, edf = 1.903",
"p = 0.0015, edf = 1.246"))
# add statistics to graph
VOL_gamplot <- vol_smooth + geom_text(data = annotation_vol,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 2.5,  nudge_y = 1)
VOL_gamplot
surf_smooth <-
ggplot(surface_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
#geom_boxplot(outlier.shape = NA, lwd=0.6, color="black", aes(fill = Color)) +
#geom_point(pch = 21, position = position_jitterdodge(), aes(fill = Color))+
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
#scale_y_continuous(expand = expansion(mult = c(0.05, 0.35)))+
scale_linetype_manual(values = c(1,2))+
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Tissue growth") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_text(face = "italic", size = 12),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
surf_smooth
