geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_discrete(limits=c(0, 10)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_discrete(breaks=c(0, 10)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = (0, 10))
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 10)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
alphavalues <- c(0.25, 0.5, 1)
necrosis$cat <- factor(necrosis$cat,
levels = c("none", "low", "moderate", "high"))
# create legend names for category names
cat_labs <-  c("", "low", "moderate", "high")
names(cat_labs) <- c("none", "low", "moderate", "high")
# Create a color scheme with switched order, so it's correct in the graph
color_scheme_2 <- c("#540B0E", "#9E2A2B", "#E09F3E", "#FFED85", "#4A8696")
necrosis_2 <- necrosis %>%
filter(cat != "none")
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2, size = 1.5)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
scale_color_manual()
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual( values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
guide = 'none',
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat), size=2) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat), size=1.3) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat), size=1.2) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat), size=1) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
necro_plot <- necrosis_2 %>%
filter(tp =="3") %>%
ggplot(aes(x=treat, y=prop, color = fct_rev(treat)))+
geom_bar(stat="identity", aes(alpha=cat), size=0.8) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
scale_alpha_manual("cat", values=alphavalues,
labels = cat_labs) +
scale_color_manual(guide = 'none', values = color_scheme_2)+
scale_x_discrete(labels = treat_labs) +
scale_y_continuous(limits = c(0, 100)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "Necrosis (%)",
title = "") +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.x = element_text(face = "italic", size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
b = 2,  # Bottom margin
l = 2)) # Left margin))
# show plot
necro_plot
# bring all growth plots together
growth_plot <- surface_plot / volume_plot / weight_plot / necro_plot
# safe all growth plots as one
ggsave("out/growth.png", plot = growth_plot,
scale = 1, width = 18, height = 26, units = c("cm"),
dpi = 600, limitsize = TRUE)
QI_II <- necro_plot / polyps
polyps <- ggplot(Polyps_wo0, aes(x = tp, y = ranks)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
geom_smooth(aes(x = tp, y = ranks, group = treat, color = treat, fill = treat)) +
scale_x_continuous(labels= c("4", "8", "12"), breaks = c(1, 2, 3)) +
scale_color_manual(values = color_scheme,
labels = treat_labs) +
scale_fill_manual(values = color_scheme,
labels = treat_labs) +
ylab("Mean polyp activity") +
xlab("Weeks of exposure") +
labs(color = expression(paste("Treatment ", mg, "·", L^-1)),
fill = expression(paste("Treatment ", mg, "·", L^-1))) +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.y = element_blank(),
strip.text.x = element_blank(), # remove species labels
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
l = 2,  # Left margin
b = 2)) # Bottom margin)
## ---- 4.3. Polyp activity ----------------------------------------------------
Polyps_wo0 <-  Polyps %>%
# select everything but the timepoint before the treatment
filter(tp!="0")
polyps <- ggplot(Polyps_wo0, aes(x = tp, y = ranks)) +
facet_grid( ~ spec,
labeller = labeller(spec = spec_labs)) +
geom_smooth(aes(x = tp, y = ranks, group = treat, color = treat, fill = treat)) +
scale_x_continuous(labels= c("4", "8", "12"), breaks = c(1, 2, 3)) +
scale_color_manual(values = color_scheme,
labels = treat_labs) +
scale_fill_manual(values = color_scheme,
labels = treat_labs) +
ylab("Mean polyp activity") +
xlab("Weeks of exposure") +
labs(color = expression(paste("Treatment ", mg, "·", L^-1)),
fill = expression(paste("Treatment ", mg, "·", L^-1))) +
# design theme
theme_classic() +
theme(panel.background = element_rect(color = "black"),
strip.background = element_blank(),
strip.text.y = element_blank(),
strip.text.x = element_blank(), # remove species labels
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.position = "top",
plot.margin = margin(t = 2,  # Top margin
r = 2,  # Right margin
l = 2,  # Left margin
b = 2)) # Bottom margin)
# show plot
polyps
QI_II <- necro_plot / polyps
# save plot
ggsave("out/QI_II.png", plot = QI_II,
scale = 1, width = 16, height = 20, units = c("cm"),
dpi = 600, limitsize = TRUE)
