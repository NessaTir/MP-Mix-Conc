value = c(4.82),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.0023, edf = 3.743",
"p = 0.0425, edf = 2.411"))
YII_gamplot <- YII_smooth + geom_text(data = annotation_YII,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
YII_gamplot
annotation_YII <- data.frame(
parameter = factor(x = c("YII"),
levels = c("YII")),
value = c(4.85),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.0023, edf = 3.743",
"p = 0.0425, edf = 2.411"))
YII_gamplot <- YII_smooth + geom_text(data = annotation_YII,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
YII_gamplot
annotation_YII <- data.frame(
parameter = factor(x = c("YII"),
levels = c("YII")),
value = c(4.875),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.0023, edf = 3.743",
"p = 0.0425, edf = 2.411"))
YII_gamplot <- YII_smooth + geom_text(data = annotation_YII,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
YII_gamplot
# create summary table with relative FvFm after 12 weeks
FvFm_s <-  FvFm_relative %>%
# select only the last timepoint
filter(tp=="3") %>%
# ignore NAs
na.omit() %>%
#rename column enrty
rename(value = relativeFv_Fm) %>%
# use mean
mutate(parameter = "FvFm")   %>%
#keep only relevant columns
dplyr::select(ID, spec, conc, value, parameter)
FvFm_s <- FvFm_s %>%
mutate(conc = as.numeric(conc),
x_axis = case_when(conc == "0" ~ "1",
conc == "0.1" ~ "2",
conc == "1" ~ "3",
conc == "10" ~ "4",
conc == "100" ~ "5"),
x_axis = as.numeric(x_axis),
Color = case_when(conc == "0" ~  "#4A8696",
conc == "0.1" ~ "#FFED85",
conc == "1" ~ "#E09F3E",
conc == "10" ~ "#9E2A2B",
conc == "100" ~ "#540B0E"))
YII_smooth <- ggplot(YII_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "log(Y(II))") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
annotation_YII <- data.frame(
parameter = factor(x = c("YII"),
levels = c("YII")),
value = c(4.875),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.0023, edf = 3.743",
"p = 0.0425, edf = 2.411"))
YII_gamplot <- YII_smooth + geom_text(data = annotation_YII,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
YII_gamplot
# create summary table with relative FvFm after 12 weeks
FvFm_s <-  FvFm_relative %>%
# select only the last timepoint
filter(tp=="3") %>%
# ignore NAs
na.omit() %>%
#rename column enrty
rename(value = relativeFv_Fm) %>%
# use mean
mutate(parameter = "FvFm")   %>%
#keep only relevant columns
dplyr::select(ID, spec, conc, value, parameter)
FvFm_s <- FvFm_s %>%
mutate(conc = as.numeric(conc),
x_axis = case_when(conc == "0" ~ "1",
conc == "0.1" ~ "2",
conc == "1" ~ "3",
conc == "10" ~ "4",
conc == "100" ~ "5"),
x_axis = as.numeric(x_axis),
Color = case_when(conc == "0" ~  "#4A8696",
conc == "0.1" ~ "#FFED85",
conc == "1" ~ "#E09F3E",
conc == "10" ~ "#9E2A2B",
conc == "100" ~ "#540B0E"))
FvFm_smooth <- ggplot(FvFm_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "log(FvFm)") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
FvFm_smooth <- ggplot(FvFm_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "log(FvFm)") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
FvFm_smooth
annotation_FvFm <- data.frame(
parameter = factor(x = c("FvFm"),
levels = c("FvFm")),
value = c(6.1),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.0592, edf = 1.572",
"p = 0.301, edf = 1.359"))
FvFm_gamplot <- FvFm_smooth + geom_text(data = annotation_FvFm,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
FvFm_gamplot
# create summary table with rETR after 12 weeks
rETR_s <-  rETR_i %>%
# select only the last timepoint
filter(tp=="3") %>%
# ignore NAs
na.omit() %>%
#rename column enrty
rename(value = rETRmax) %>%
# use mean
mutate(parameter = "rETRmax")   %>%
#keep only relevant columns
dplyr::select(ID, spec, conc, value, parameter)
rETR_s <- rETR_s %>%
mutate(conc = as.numeric(conc),
x_axis = case_when(conc == "0" ~ "1",
conc == "0.1" ~ "2",
conc == "1" ~ "3",
conc == "10" ~ "4",
conc == "100" ~ "5"),
x_axis = as.numeric(x_axis),
Color = case_when(conc == "0" ~  "#4A8696",
conc == "0.1" ~ "#FFED85",
conc == "1" ~ "#E09F3E",
conc == "10" ~ "#9E2A2B",
conc == "100" ~ "#540B0E"))
rETR_smooth <- ggplot(rETR_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "log(FvFm)") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
rETR_smooth
## ---- 4.08. rETRmax ----------------------------------------------------------
### --- 4.08.1. Pve ------------------------------------------------------------
rETR_Pve <- subset(rETR, spec == "Pve") %>%
mutate(conc_log = log(conc+1),
value_log = log(value))
# fit GAM
mod_gam1 = gam(value_log ~ s(conc_log, bs = "cr", k = 5), data = rETR_Pve)
summary(mod_gam1)
annotation_rETR <- data.frame(
parameter = factor(x = c("rETRmax"),
levels = c("rETRmax")),
value = c(5.5),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.657, edf = 1",
"p = 0.665, edf = 1"))
rETR_gamplot  <- rETR_smooth + geom_text(data = annotation_rETR,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
rETR_gamplot
# create summary table with Ek after 12 weeks
Ek_s <-  rETR_i %>%
# select only the last timepoint
filter(tp=="3") %>%
# ignore NAs
na.omit() %>%
#rename column enrty
rename(value = Ek) %>%
# use mean
mutate(parameter = "Ek")   %>%
#keep only relevant columns
dplyr::select(ID, spec, conc, value, parameter)
Ek_s <- Ek_s %>%
mutate(conc = as.numeric(conc),
x_axis = case_when(conc == "0" ~ "1",
conc == "0.1" ~ "2",
conc == "1" ~ "3",
conc == "10" ~ "4",
conc == "100" ~ "5"),
x_axis = as.numeric(x_axis),
Color = case_when(conc == "0" ~  "#4A8696",
conc == "0.1" ~ "#FFED85",
conc == "1" ~ "#E09F3E",
conc == "10" ~ "#9E2A2B",
conc == "100" ~ "#540B0E"))
Ek_smooth <- ggplot(Ek_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "log(Ek)") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 10),
axis.text.x = element_blank(),
legend.position = "none")
Ek_smooth
annotation_Ek <- data.frame(
parameter = factor(x = c("Ek"),
levels = c("Ek")),
value = c(6.5),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.523, edf = 1",
"p = 0.689, edf = 1.048"))
Ek_gamplot <- Ek_smooth + geom_text(data = annotation_Ek,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
Ek_gamplot
annotation_Ek <- data.frame(
parameter = factor(x = c("Ek"),
levels = c("Ek")),
value = c(6.5),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.523, edf = 1",
"p = 0.689, edf = 1.048"))
Ek_gamplot <- Ek_smooth + geom_text(data = annotation_Ek,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
Ek_gamplot
annotation_Ek <- data.frame(
parameter = factor(x = c("Ek"),
levels = c("Ek")),
value = c(6.4),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.523, edf = 1",
"p = 0.689, edf = 1.048"))
Ek_gamplot <- Ek_smooth + geom_text(data = annotation_Ek,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
Ek_gamplot
# create summary table with alpha after 12 weeks
alpha_s <-  rETR_i %>%
# select only the last timepoint
filter(tp=="3") %>%
# ignore NAs
na.omit() %>%
#rename column enrty
rename(value = alpha) %>%
# use mean
mutate(parameter = "alpha")   %>%
#keep only relevant columns
dplyr::select(ID, spec, conc, value, parameter)
alpha_s <- alpha_s %>%
mutate(conc = as.numeric(conc),
x_axis = case_when(conc == "0" ~ "1",
conc == "0.1" ~ "2",
conc == "1" ~ "3",
conc == "10" ~ "4",
conc == "100" ~ "5"),
x_axis = as.numeric(x_axis),
Color = case_when(conc == "0" ~  "#4A8696",
conc == "0.1" ~ "#FFED85",
conc == "1" ~ "#E09F3E",
conc == "10" ~ "#9E2A2B",
conc == "100" ~ "#540B0E"))
alpha_s <- alpha_s %>%
mutate(conc = as.numeric(conc),
x_axis = case_when(conc == "0" ~ "1",
conc == "0.1" ~ "2",
conc == "1" ~ "3",
conc == "10" ~ "4",
conc == "100" ~ "5"),
x_axis = as.numeric(x_axis),
Color = case_when(conc == "0" ~  "#4A8696",
conc == "0.1" ~ "#FFED85",
conc == "1" ~ "#E09F3E",
conc == "10" ~ "#9E2A2B",
conc == "100" ~ "#540B0E"))
alpha_smooth <- ggplot(alpha_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "log(alpha)") +
theme_bw()+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 10),
legend.position = "none")
alpha_smooth <- ggplot(alpha_s, aes(x = x_axis, y = log(value),
color = Color)) +
scale_color_identity() +
facet_grid(~ spec,
labeller = labeller(spec = spec_labs)) +
geom_point() +
geom_smooth(aes(x = x_axis, y = log(value)), method = "gam",
formula = y ~ s(x, bs = "cs", fx = TRUE, k = 5),
color = "black") +
scale_x_continuous(labels= c("control", "0.1", "1", "10", "100"),
breaks = c(1, 2, 3, 4, 5)) +
labs(x = expression(paste("Treatment ", mg, "·", L^-1)),
y = "log(alpha)") +
theme_bw()+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.background = element_blank(),
panel.background = element_rect(colour = "black"),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 10),
legend.position = "none")
alpha_smooth
annotation_alpha <- data.frame(
parameter = factor(x = c("alpha"),
levels = c("alpha")),
value = c(-0.5),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.528, edf = 1",
"p = 0.845, edf = 1"))
ALPHA_gamplot <- alpha_smooth + geom_text(data = annotation_alpha,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
ALPHA_gamplot
annotation_alpha <- data.frame(
parameter = factor(x = c("alpha"),
levels = c("alpha")),
value = c(0),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.528, edf = 1",
"p = 0.845, edf = 1"))
ALPHA_gamplot <- alpha_smooth + geom_text(data = annotation_alpha,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
ALPHA_gamplot
annotation_alpha <- data.frame(
parameter = factor(x = c("alpha"),
levels = c("alpha")),
value = c(-0.25),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.528, edf = 1",
"p = 0.845, edf = 1"))
ALPHA_gamplot <- alpha_smooth + geom_text(data = annotation_alpha,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
ALPHA_gamplot
annotation_alpha <- data.frame(
parameter = factor(x = c("alpha"),
levels = c("alpha")),
value = c(-0.3),
conc = c(4.25),
spec = c("Pve", "Spi"),
label = c("p = 0.528, edf = 1",
"p = 0.845, edf = 1"))
ALPHA_gamplot <- alpha_smooth + geom_text(data = annotation_alpha,
mapping = aes(x = conc, y = value,
label = label),
color = "black",
size = 3)
ALPHA_gamplot
gamplots <- # bring all growth plots together
SURF_gamplot / VOL_gamplot / CALC_gamplot / NECRO_gamplot / POLYP_gamplot / YII_gamplot / FvFm_gamplot / rETR_gamplot / Ek_gamplot / ALPHA_gamplot
gamplots
# safe graph
ggsave("out/gam_correlation.png", plot = gamplots,
scale = 1, width = 24, height = 42, units = c("cm"),
dpi = 600, limitsize = TRUE)
# safe graph
ggsave("out/gam_correlation.png", plot = gamplots,
scale = 1, width = 24, height = 48, units = c("cm"),
dpi = 600, limitsize = TRUE)
# safe graph
ggsave("out/gam_correlation.png", plot = gamplots,
scale = 1, width = 24, height = 54, units = c("cm"),
dpi = 600, limitsize = TRUE)
